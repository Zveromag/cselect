/***Autor Zveerko; GitHub (https://github.com/Zveromag/)***/(function(t){"use strict";function s(t){t=t||{};for(var i=1;i<arguments.length;i++){var e=arguments[i];if(e)for(var h in e)e.hasOwnProperty(h)&&("object"==typeof e[h]?t[h]=s(t[h],e[h]):t[h]=e[h])}return t}function i(t,s){return s.indexOf(t)}function e(i,e){if(!(i instanceof Node))throw new Error("el must be a Node");this.mainSelect=i,this.activeClass="is-active",this.settings=s({animations:"",maxWidth:0,onChange:function(){}},e),this.KEYS={ENTER:13,DOWN:40,ESC:27,UP:38},this.slWrap=document.createElement("div"),this.slWrap.className="select-js__box",this.slWrap.innerHTML='<div class="select-js__name"></div>',this.slListExt=document.createElement("ul"),this.slListExt.className="select-js__list",this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option")),this.resizeEvent=this.position.bind(this),this.toggleEvent=this.toggle.bind(this),this.listEvent=this.clickItem.bind(this),this.nameEvent=this.clickName.bind(this),this.keybordEvent=this.keydown.bind(this),this.createSelect(),this.slTitle.addEventListener("click",this.toggleEvent),this.slListExt.addEventListener("click",this.listEvent),this.slWrap.addEventListener("click",this.nameEvent),t.addEventListener("resize",this.resizeEvent),document.documentElement.addEventListener("keydown",this.keybordEvent)}e.prototype.genOptions=function(t){var s=document.createDocumentFragment();return this.options.forEach(function(t){var i=t.hasAttribute("selected"),e=document.createElement("li");e.className="select-js__item",e.dataset.selected=i,e.dataset.get=t.value,e.textContent=t.textContent,s.appendChild(e)}),s},e.prototype.createSelect=function(){this.slListExt.appendChild(this.genOptions()),this.slWrap.appendChild(this.slListExt),this.mainSelect.parentNode.insertBefore(this.slWrap,this.mainSelect),this.slTitle=this.slWrap.querySelector(".select-js__name"),this.slList=this.slWrap.querySelector(".select-js__list"),this.slItems=Array.prototype.slice.call(this.slWrap.querySelectorAll(".select-js__item")),this.listHeight=this.slList.offsetHeight,this.listLength=this.slItems.length,this.mainSelectWidth=parseInt(this.settings.maxWidth)<=this.mainSelect.offsetWidth?this.mainSelect.offsetWidth:parseInt(this.settings.maxWidth),this.isOpen=!1,this.position(),this.settings.animations.length>0&&this.slList.classList.add(this.settings.animations),this.slItems.forEach(function(t){"true"===t.dataset.selected&&(this.slTitle.textContent=t.textContent,t.classList.add(this.activeClass))}.bind(this)),this.mainSelect.setAttribute("hidden","hidden")},e.prototype.position=function(){var i=t.innerHeight,e=this.slTitle.offsetHeight,h=this.slWrap.offsetTop-t.pageYOffset,n=i-h-e;this.settings.maxWidth?(this.slWrap.style.width="100%",this.slWrap.style.maxWidth=this.settings.maxWidth+"px"):this.slWrap.style.width=this.mainSelect.offsetWidth+"px",n<=h?s(this.slList.style,{top:"auto",bottom:e+"px","border-bottom":0,"border-top":""}):s(this.slList.style,{top:e+"px",bottom:"auto","border-bottom":"","border-top":0}),this.settings.maxWidth?s(this.slList.style,{width:"100%","max-width":this.settings.maxWidth+"px"}):this.slList.style.width=this.mainSelect.offsetWidth+"px"},e.prototype.move=function(t){var s=this.slList.querySelector("."+this.activeClass),e=i(s,this.slItems);e>=0&&(t===this.KEYS.UP&&(e-=1),t===this.KEYS.DOWN&&(e+=1),e<0||e>=this.listLength||(this.highlight(e),this.activated(e),this.scroll(e)))},e.prototype.highlight=function(t){this.slList.querySelector("."+this.activeClass).classList.remove(this.activeClass),this.slItems[t].classList.add(this.activeClass)},e.prototype.activated=function(t){var s=this.slItems[t];this.slTitle.textContent=s.textContent},e.prototype.get=function(){var t=this.slList.querySelector("."+this.activeClass),s=i(t,this.slItems);this.settings.onChange(t.dataset.get,t.textContent,s),this.options.forEach(function(t){t.removeAttribute("selected")}),this.options[s].setAttribute("selected",!0),this.close()},e.prototype.scroll=function(t){var s=this.slList.scrollHeight,i=this.slList.scrollTop;if(s>this.listHeight){var e=this.slItems[t].getBoundingClientRect().top+document.body.scrollTop,h=this.slList.getBoundingClientRect().top+document.body.scrollTop;this.slList.scrollTop=e-(h-i)}},e.prototype.toggle=function(){this.isOpen||this.position(),this.slTitle.classList.toggle("is-open"),this.slList.classList.toggle("is-open"),this.isOpen=!this.isOpen},e.prototype.close=function(){this.slTitle.classList.remove("is-open"),this.slList.classList.remove("is-open"),this.isOpen=!1},e.prototype.clickItem=function(t){var s=t.target.closest("li");if(s){var e=i(s,this.slItems);this.highlight(e),this.activated(e),this.get(e)}},e.prototype.clickName=function(t){t.target.closest(".select-js__name")||this.isOpen&&this.close()},e.prototype.keydown=function(t){this.isOpen&&(t.which===this.KEYS.ENTER&&this.get(),t.which===this.KEYS.ESC&&this.close(),t.which!==this.KEYS.UP&&t.which!==this.KEYS.DOWN||(t.preventDefault(),this.move(t.which)))},t.Select=e})(this);