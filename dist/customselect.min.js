!function(t){"use strict";function e(t){t=t||{};for(var s=1;s<arguments.length;s++){var i=arguments[s];if(i)for(var n in i)i.hasOwnProperty(n)&&("object"==typeof i[n]?t[n]=e(t[n],i[n]):t[n]=i[n])}return t}function s(t,e){return e.indexOf(t)}function i(t){var e=[];if(!t)return e;for(;t=t.nextSibling;)1===t.nodeType&&e.push(t);return e}function n(t){var e=[];if(!t)return e;for(;t=t.previousSibling;)1===t.nodeType&&e.push(t);return e}function o(s,i){if(!(s instanceof Node))throw new Error("el must be a Node");this.mainSelect=s,this.activeClass="is-active",this.currentIndex=0,this.settings=e({animations:"",maxWidth:0,onChange:function(){}},i),this.KEYS={ENTER:13,DOWN:40,ESC:27,UP:38},this.slWrap=document.createElement("div"),this.slWrap.className="select-js__box",this.slWrap.innerHTML='<div class="select-js__name"></div>',this.slListExt=document.createElement("ul"),this.slListExt.className="select-js__list",this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option")),this.resizeEvent=this.position.bind(this),this.toggleEvent=this.toggle.bind(this),this.listEvent=this.clickItem.bind(this),this.nameEvent=this.clickName.bind(this),this.keybordEvent=this.keydown.bind(this),this.closeEvent=this.clickDocument.bind(this),this.createSelect(),this.slTitle.addEventListener("click",this.toggleEvent),this.slListExt.addEventListener("click",this.listEvent),this.slWrap.addEventListener("click",this.nameEvent),t.addEventListener("resize",this.resizeEvent),document.documentElement.addEventListener("keydown",this.keybordEvent),document.documentElement.addEventListener("click",this.closeEvent)}o.prototype.genOptions=function(t){var e=document.createDocumentFragment();return this.options.forEach(function(t){var s=t.hasAttribute("selected"),i=t.hasAttribute("disabled"),n=document.createElement("li");n.className="select-js__item",n.dataset.selected=s,i&&(n.dataset.disabled=i,n.className="select-js__item select-js__item--disabled"),n.dataset.get=t.value,n.textContent=t.textContent,e.appendChild(n)}),e},o.prototype.createSelect=function(){this.slListExt.appendChild(this.genOptions()),this.slWrap.appendChild(this.slListExt),this.mainSelect.parentNode.insertBefore(this.slWrap,this.mainSelect.nextSibling),this.slTitle=this.slWrap.querySelector(".select-js__name"),this.slList=this.slWrap.querySelector(".select-js__list"),this.slItems=Array.prototype.slice.call(this.slWrap.querySelectorAll(".select-js__item")),this.listHeight=this.slList.offsetHeight,this.listLength=this.slItems.length,this.mainSelectWidth=parseInt(this.settings.maxWidth)<=this.mainSelect.offsetWidth?this.mainSelect.offsetWidth:parseInt(this.settings.maxWidth),this.isOpen=!1,this.position(),this.settings.animations.length>0&&this.slList.classList.add(this.settings.animations),this.slItems.forEach(function(t){"true"===t.dataset.selected&&(this.slTitle.textContent=t.textContent,t.classList.add(this.activeClass))}.bind(this)),this.mainSelect.setAttribute("hidden","hidden")},o.prototype.position=function(){var s=t.innerHeight,i=this.slTitle.offsetHeight,n=this.slWrap.offsetTop-t.pageYOffset,o=s-n-i;this.settings.maxWidth?(this.slWrap.style.width="100%",this.slWrap.style.maxWidth=this.settings.maxWidth+"px"):this.slWrap.style.width=this.mainSelectWidth+"px",o<=n?e(this.slList.style,{top:"auto",bottom:i+"px","border-bottom":0,"border-top":""}):e(this.slList.style,{top:i+"px",bottom:"auto","border-bottom":"","border-top":0}),this.settings.maxWidth?e(this.slList.style,{width:"100%","max-width":this.settings.maxWidth+"px"}):this.slList.style.width=this.mainSelectWidth+"px"},o.prototype.move=function(t){var e=this.slList.querySelector("."+this.activeClass);this.currentIndex=s(e,this.slItems),t===this.KEYS.DOWN&&this.moveDown(),t===this.KEYS.UP&&this.moveUp(),this.highlight(this.currentIndex),this.activated(this.currentIndex),this.scroll(this.currentIndex)},o.prototype.moveDown=function(){var t=this;t.currentIndex+=1;var e=!1,s=i(t.slItems[t.currentIndex]).some(function(t){return!t.dataset.disabled});if(t.slItems[t.currentIndex]&&t.slItems[t.currentIndex].dataset.disabled&&(e=!0),t.currentIndex===t.listLength)t.currentIndex-=1;else if(e&&s)return t.moveDown();e&&!s&&(t.currentIndex-=1)},o.prototype.moveUp=function(){var t=this;t.currentIndex-=1;var e=!1,s=n(t.slItems[t.currentIndex]).some(function(t){return!t.dataset.disabled});if(t.slItems[t.currentIndex]&&t.slItems[t.currentIndex].dataset.disabled&&(e=!0),-1===t.currentIndex)t.currentIndex+=1;else if(e&&s)return t.moveUp();e&&!s&&(t.currentIndex+=1)},o.prototype.highlight=function(t){this.slList.querySelector("."+this.activeClass).classList.remove(this.activeClass),this.slItems[t].classList.add(this.activeClass)},o.prototype.activated=function(t){var e=this.slItems[t];this.slTitle.textContent=e.textContent},o.prototype.get=function(){var t=this.slList.querySelector("."+this.activeClass);if(!t.dataset.disabled){var e=s(t,this.slItems);this.settings.onChange(t.dataset.get,t.textContent,e),this.options.forEach(function(t){t.removeAttribute("selected")}),this.options[e].setAttribute("selected",!0),this.close()}},o.prototype.scroll=function(t){var e=this.slList.scrollHeight,s=this.slList.scrollTop;if(e>this.listHeight){var i=this.slItems[t].getBoundingClientRect().top+document.body.scrollTop,n=this.slList.getBoundingClientRect().top+document.body.scrollTop;this.slList.scrollTop=i-(n-s)}},o.prototype.toggle=function(){this.isOpen||this.position(),this.slTitle.classList.toggle("is-open"),this.slList.classList.toggle("is-open"),this.isOpen=!this.isOpen},o.prototype.close=function(t){this.isOpen&&(this.slTitle.classList.remove("is-open"),this.slList.classList.remove("is-open"),this.isOpen=!1)},o.prototype.clickItem=function(t){var e=t.target.closest("li");if(e&&!e.dataset.disabled){var i=s(e,this.slItems);this.highlight(i),this.activated(i),this.get(i)}},o.prototype.clickName=function(t){t.target.closest(".select-js__name")||this.isOpen&&this.close()},o.prototype.keydown=function(t){this.isOpen&&(t.which===this.KEYS.ENTER&&this.get(),t.which===this.KEYS.ESC&&this.close(),t.which!==this.KEYS.UP&&t.which!==this.KEYS.DOWN||(t.preventDefault(),this.move(t.which)))},o.prototype.clickDocument=function(t){t.target.classList.contains("select-js__name")||this.close()},o.prototype.destroy=function(){this.slTitle.removeEventListener("click",this.toggleEvent),this.slListExt.removeEventListener("click",this.listEvent),this.slWrap.removeEventListener("click",this.nameEvent),t.removeEventListener("resize",this.resizeEvent),document.documentElement.removeEventListener("keydown",this.keybordEvent),document.documentElement.removeEventListener("click",this.closeEvent),this.slWrap.removeChild(this.slListExt),this.slWrap.parentNode.removeChild(this.slWrap),this.mainSelect.removeAttribute("hidden");for(var e in this)delete this[e]},t.Select=o}(this);