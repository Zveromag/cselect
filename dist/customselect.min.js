this.Element&&function(t){t.matches=t.matches||t.matchesSelector||t.webkitMatchesSelector||t.msMatchesSelector||function(t){for(var s=this,e=(s.parentNode||s.document).querySelectorAll(t),i=-1;e[++i]&&e[i]!=s;);return!!e[i]}}(Element.prototype),this.Element&&function(t){t.closest=t.closest||function(t){for(var s=this;s.matches&&!s.matches(t);)s=s.parentNode;return s.matches?s:null}}(Element.prototype),function(t){"use strict";function s(t,s){function e(){if(o)return i=arguments,void(n=this);t.apply(this,arguments),o=!0,setTimeout(function(){o=!1,i&&(e.apply(n,i),i=n=null)},s)}var i,n,o=!1;return e}function e(t){t=t||{};for(var s=1;s<arguments.length;s++){var i=arguments[s];if(i)for(var n in i)i.hasOwnProperty(n)&&("object"==typeof i[n]?t[n]=e(t[n],i[n]):t[n]=i[n])}return t}function i(t,s){return s.indexOf(t)}function n(t){var s=[];if(!t)return s;for(;t=t.nextSibling;)1===t.nodeType&&s.push(t);return s}function o(t){var s=[];if(!t)return s;for(;t=t.previousSibling;)1===t.nodeType&&s.push(t);return s}function h(i,n){if(!(i instanceof Node))throw new Error("el must be a Node");this.mainSelect=i,this.activeClass="is-active",this.isFocus=!1,this.currentIndex=0,this.settings=e({maxWidth:0,customClass:"",animation:null,showMaxOptions:null,onChange:function(){}},n),this.KEYS={ENTER:13,SPACE:32,DOWN:40,ESC:27,UP:38},this.slWrap=document.createElement("div"),this.slWrap.className="cs",this.slWrap.setAttribute("tabindex",0),this.settings.customClass&&this.slWrap.classList.add(this.settings.customClass),this.slTitle=document.createElement("div"),this.slTitle.className="cs-label",this.slList=document.createElement("ul"),this.slList.className="cs-list",this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option")),this.rePosition=s(this.positionHandler.bind(this),250),this.toggleEvent=this.toggle.bind(this),this.listEvent=this.clickItem.bind(this),this.keybordEvent=this.keydown.bind(this),this.closeEvent=this.clickDocument.bind(this),this.hasFocus=this.focusState.bind(this),this.createSelect(),this.slList.addEventListener("click",this.listEvent),this.slWrap.addEventListener("click",this.toggleEvent),this.slWrap.addEventListener("keydown",this.keybordEvent),this.slWrap.addEventListener("focus",this.hasFocus,!0),this.slWrap.addEventListener("blur",this.hasFocus,!0),t.addEventListener("resize",this.rePosition),t.addEventListener("scroll",this.rePosition),document.documentElement.addEventListener("click",this.closeEvent)}h.prototype={genOptions:function(t){this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option, optgroup"));var s=document.createDocumentFragment();return this.options.forEach(function(t,e){var i=t.hasAttribute("disabled"),n=t.matches("optgroup"),o=t.closest("optgroup"),h=document.createElement("li");h.classList.add("cs-item"),e===this.mainSelect.selectedIndex&&h.setAttribute("data-selected",!0),i&&(h.setAttribute("data-disabled",i),h.classList.add("cs-item--disabled")),n?(h.setAttribute("data-optgroup",n),h.classList.add("cs-item--group"),h.textContent=t.getAttribute("for")):(o&&(o.hasAttribute("disabled")&&(h.setAttribute("data-disabled",!0),h.classList.add("cs-item--disabled")),h.classList.add("cs-item--groupchild")),h.setAttribute("data-value",t.value),h.textContent=t.textContent),s.appendChild(h)}.bind(this)),s},genList:function(){this.slList.appendChild(this.genOptions()),this.slItems=Array.prototype.slice.call(this.slWrap.querySelectorAll(".cs-item")),this.slItems.forEach(function(t){if("true"===t.getAttribute("data-selected"))return this.slTitle.textContent=t.textContent,void t.classList.add(this.activeClass)}.bind(this)),this.listLength=this.slItems.length},createSelect:function(){if(this.slWrap.appendChild(this.slTitle),this.slWrap.appendChild(this.slList),this.genList(),this.mainSelect.parentNode.insertBefore(this.slWrap,this.mainSelect.nextSibling),this.listHeight=this.slList.offsetHeight,this.mainSelectWidth=parseInt(this.settings.maxWidth)<=this.mainSelect.offsetWidth?this.mainSelect.offsetWidth:parseInt(this.settings.maxWidth),this.settings.maxWidth?(this.slWrap.style.width="100%",this.slWrap.style.maxWidth=this.settings.maxWidth+"px"):this.slWrap.style.width=this.mainSelectWidth+"px",this.settings.showMaxOptions){var t=this.slTitle.offsetHeight,s=this.slItems.length;if(this.settings.showMaxOptions<=s){var e=t*this.settings.showMaxOptions;this.slList.style.maxHeight=e+"px"}}this.position(),this.settings.animation&&this.slList.classList.add(this.settings.animation),this.mainSelect.setAttribute("hidden","hidden")},toggle:function(){this.isOpen||this.position(),this.slWrap.classList.toggle("is-open"),this.isOpen=!this.isOpen},close:function(t){this.isOpen&&(this.slWrap.classList.remove("is-open"),this.isOpen=!1)},position:function(s){var i=t.innerHeight,n=this.slTitle.offsetHeight,o=this.slWrap.offsetTop-t.pageYOffset;i-o-n<=o?(this.slList.classList.remove("below"),this.slList.classList.add("above"),e(this.slList.style,{top:"",bottom:n+"px","border-bottom":0,"border-top":""})):(this.slList.classList.remove("above"),this.slList.classList.add("below"),e(this.slList.style,{top:n+"px",bottom:"","border-bottom":"","border-top":0})),this.settings.maxWidth?e(this.slList.style,{width:"100%","max-width":this.settings.maxWidth+"px"}):this.slList.style.width=this.mainSelectWidth+"px"},focusState:function(t){var s=t.type;this.isFocus="focus"===s,"blur"===s&&this.isOpen&&document.activeElement!==this.slWrap&&this.close()},positionHandler:function(t){this.isOpen&&this.position()},move:function(t){var s=this.slList.querySelector("."+this.activeClass);this.currentIndex=i(s,this.slItems),t===this.KEYS.DOWN&&this.moveDown(),t===this.KEYS.UP&&this.moveUp(),this.selection(),this.scroll()},moveDown:function(){var t=this;t.currentIndex+=1;var s=!1,e=t.slItems[t.currentIndex],i=n(e).some(function(t){return!t.hasAttribute("data-disabled")&&!t.hasAttribute("data-optgroup")});if(e&&(e.hasAttribute("data-disabled")||e.hasAttribute("data-optgroup"))&&(s=!0),t.currentIndex===t.listLength)t.currentIndex-=1;else if(s&&i)return t.moveDown();s&&!i&&(t.currentIndex-=1)},moveUp:function(){var t=this;t.currentIndex-=1;var s=!1,e=t.slItems[t.currentIndex],i=o(e).some(function(t){return!t.hasAttribute("data-disabled")&&!t.hasAttribute("data-optgroup")});if(e&&(e.hasAttribute("data-disabled")||e.hasAttribute("data-optgroup"))&&(s=!0),-1===t.currentIndex)t.currentIndex+=1;else if(s&&i)return t.moveUp();s&&!i&&(t.currentIndex+=1)},selection:function(){var t=this.slItems[this.currentIndex];this.slList.querySelector("."+this.activeClass).classList.remove(this.activeClass),t.classList.add(this.activeClass),this.slTitle.textContent=t.textContent},get:function(t){var s=this.slList.querySelector("."+this.activeClass);s.hasAttribute("data-disabled")||(this.settings.onChange(t,s.getAttribute("data-value"),s.textContent,this.currentIndex),this.options.forEach(function(t){t.removeAttribute("selected")}),this.options[this.currentIndex].setAttribute("selected",!0),"keydown"===t.type&&t.which!==this.KEYS.ENTER||this.close())},scroll:function(){var t=this.slList.getBoundingClientRect(),s=this.slItems[this.currentIndex].getBoundingClientRect();t.top>s.top?this.slList.scrollTop=this.slList.scrollTop-t.top+s.top:t.bottom<s.bottom&&(this.slList.scrollTop=this.slList.scrollTop-t.bottom+s.bottom)},clickItem:function(t){var s=t.target.closest("li");s&&(s.hasAttribute("data-disabled")||s.hasAttribute("data-optgroup")?t.stopPropagation():(this.currentIndex=i(s,this.slItems),this.selection(),this.get(t)))},keydown:function(t){this.isFocus&&(t.which===this.KEYS.ENTER&&(t.preventDefault(),this.isOpen&&this.get(t)),t.which===this.KEYS.SPACE&&(t.preventDefault(),this.toggle()),t.which===this.KEYS.ESC&&this.close(),t.which!==this.KEYS.UP&&t.which!==this.KEYS.DOWN||(t.preventDefault(),this.move(t.which),this.get(t)))},clickDocument:function(t){this.isOpen&&(t.target.classList.contains("cs-label")||this.close())},update:function(){this.slList.innerHTML="",this.genList()},destroy:function(){this.slList.removeEventListener("click",this.listEvent),this.slWrap.removeEventListener("click",this.toggleEvent),this.slWrap.removeEventListener("keydown",this.keybordEvent),this.slWrap.removeEventListener("focus",this.hasFocus,!0),this.slWrap.removeEventListener("blur",this.hasFocus,!0),t.removeEventListener("resize",this.rePosition),t.removeEventListener("scroll",this.rePosition),document.documentElement.removeEventListener("click",this.closeEvent),this.slWrap.removeChild(this.slList),this.slWrap.removeChild(this.slTitle),this.slWrap.parentNode.removeChild(this.slWrap),this.mainSelect.removeAttribute("hidden");for(var s in this)delete this[s]}},t.Select=h}(this);