/*! CSelect v1.0.1 | MIT License | https://github.com/Zveromag/cselect */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("CSelect",[],e):"object"==typeof exports?exports.CSelect=e():t.CSelect=e()}(window,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){s(1),t.exports=s(3)},function(t,e,s){},function(t,e){!function(t){"function"!=typeof t.matches&&(t.matches=t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),s=0;e[s]&&e[s]!==this;)++s;return Boolean(e[s])}),"function"!=typeof t.closest&&(t.closest=function(t){for(var e=this;e&&1===e.nodeType;){if(e.matches(t))return e;e=e.parentNode}return null})}(window.Element.prototype)},function(t,e,s){"use strict";s.r(e);s(2);var i=function(t,e){var s,i,n=!1;return function o(){if(n)return s=arguments,void(i=this);t.apply(this,arguments),n=!0,setTimeout(function(){n=!1,s&&(o.apply(i,s),s=i=null)},e)}},n=function(t,e){return e.indexOf(t)},o=function(t){var e=[];if(!t)return e;for(;t=t.nextSibling;)1===t.nodeType&&e.push(t);return e},l=function(t){var e=[];if(!t)return e;for(;t=t.previousSibling;)1===t.nodeType&&e.push(t);return e};function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t}).apply(this,arguments)}function a(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e,s){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof Node))throw new Error("el must be a Node");this.mainSelect=e,this.activeClass="is-active",this.selectClass="cs",this.isFocus=!1,this.currentIndex=0,this.settings=r({maxWidth:0,customClass:"",animation:null,showMaxOptions:null,onChange:function(){}},s),this.KEYS={ENTER:13,SPACE:32,DOWN:40,ESC:27,UP:38},this._init()}return function(t,e,s){e&&a(t.prototype,e),s&&a(t,s)}(t,[{key:"_init",value:function(){this.slWrap=document.createElement("div"),this.slWrap.className=this.selectClass,this.slWrap.setAttribute("tabindex",0),this.settings.customClass&&this.slWrap.classList.add(this.settings.customClass),this.slTitle=document.createElement("div"),this.slTitle.className="".concat(this.selectClass,"-label"),this.slList=document.createElement("ul"),this.slList.className="".concat(this.selectClass,"-list"),this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option")),this._positionHandler=i(this._positionHandler.bind(this),250),this._toggleHandler=this._toggleHandler.bind(this),this._clickHandler=this._clickHandler.bind(this),this._keyboardHandler=this._keyboardHandler.bind(this),this._closeHandler=this._closeHandler.bind(this),this._focusHandler=this._focusHandler.bind(this),this._createSelect(),this._bindEvents()}},{key:"_bindEvents",value:function(){this.slList.addEventListener("click",this._clickHandler),this.slWrap.addEventListener("click",this._toggleHandler),this.slWrap.addEventListener("keydown",this._keyboardHandler),this.slWrap.addEventListener("focus",this._focusHandler,!0),this.slWrap.addEventListener("blur",this._focusHandler,!0),window.addEventListener("resize",this._positionHandler),window.addEventListener("scroll",this._positionHandler),document.documentElement.addEventListener("click",this._closeHandler)}},{key:"_unbindEvents",value:function(){this.slList.removeEventListener("click",this._clickHandler),this.slWrap.removeEventListener("click",this._toggleHandler),this.slWrap.removeEventListener("keydown",this._keyboardHandler),this.slWrap.removeEventListener("focus",this._focusHandler,!0),this.slWrap.removeEventListener("blur",this._focusHandler,!0),window.removeEventListener("resize",this._positionHandler),window.removeEventListener("scroll",this._positionHandler),document.documentElement.removeEventListener("click",this._closeHandler)}},{key:"_createSelect",value:function(){if(this.slWrap.appendChild(this.slTitle),this.slWrap.appendChild(this.slList),this._genList(),this.mainSelect.parentNode.insertBefore(this.slWrap,this.mainSelect.nextSibling),this.listHeight=this.slList.offsetHeight,this.mainSelectWidth=parseInt(this.settings.maxWidth)<=this.mainSelect.offsetWidth?this.mainSelect.offsetWidth:parseInt(this.settings.maxWidth),this.settings.maxWidth?(this.slWrap.style.width="100%",this.slWrap.style.maxWidth=this.settings.maxWidth+"px"):this.slWrap.style.width=this.mainSelectWidth+"px",this.settings.showMaxOptions){var t=this.slTitle.offsetHeight,e=this.slItems.length;if(this.settings.showMaxOptions<=e){var s=t*this.settings.showMaxOptions;this.slList.style.maxHeight=s+"px"}}this._position(),this.settings.animation&&this.slList.classList.add(this.settings.animation),this.mainSelect.setAttribute("hidden","hidden")}},{key:"_genOptions",value:function(t){this.options=Array.prototype.slice.call(this.mainSelect.querySelectorAll("option, optgroup"));var e=document.createDocumentFragment();return this.options.forEach(function(t,s){var i=t.hasAttribute("disabled"),n=t.matches("optgroup"),o=t.closest("optgroup"),l=document.createElement("li");l.classList.add("".concat(this.selectClass,"-item")),s===this.mainSelect.selectedIndex&&l.setAttribute("data-selected",!0),i&&(l.setAttribute("data-disabled",i),l.classList.add("".concat(this.selectClass,"-item--disabled"))),n?(l.setAttribute("data-optgroup",n),l.classList.add("".concat(this.selectClass,"-item--group")),l.textContent=t.getAttribute("for")):(o&&(o.hasAttribute("disabled")&&(l.setAttribute("data-disabled",!0),l.classList.add("".concat(this.selectClass,"-item--disabled"))),l.classList.add("".concat(this.selectClass,"-item--groupchild"))),l.setAttribute("data-value",t.value),l.textContent=t.textContent),e.appendChild(l)}.bind(this)),e}},{key:"_genList",value:function(){var t=this;this.slList.appendChild(this._genOptions()),this.slItems=Array.prototype.slice.call(this.slWrap.querySelectorAll(".".concat(this.selectClass,"-item"))),this.slItems.forEach(function(e){if("true"===e.getAttribute("data-selected"))return t.slTitle.textContent=e.textContent,void e.classList.add(t.activeClass)}),this.listLength=this.slItems.length}},{key:"_position",value:function(t){var e=window.innerHeight,s=this.slTitle.offsetHeight,i=this.slWrap.getBoundingClientRect().top;e-i-s<=i?(this.slList.classList.remove("below"),this.slList.classList.add("above"),r(this.slList.style,{top:"",bottom:"".concat(s,"px"),"border-bottom":0,"border-top":""})):(this.slList.classList.remove("above"),this.slList.classList.add("below"),r(this.slList.style,{top:"".concat(s,"px"),bottom:"","border-bottom":"","border-top":0})),this.settings.maxWidth?r(this.slList.style,{"max-width":"".concat(this.mainSelectWidth,"px"),width:"100%"}):this.slList.style.width=this.mainSelectWidth+"px"}},{key:"_close",value:function(){this.isOpen&&(this.slWrap.classList.remove("is-open"),this.isOpen=!1)}},{key:"_positionHandler",value:function(){this.isOpen&&this._position()}},{key:"_toggleHandler",value:function(){this.isOpen||this._position(),this.slWrap.classList.toggle("is-open"),this.isOpen=!this.isOpen}},{key:"_focusHandler",value:function(t){var e=t.type;this.isFocus="focus"===e,"blur"===e&&this.isOpen&&document.activeElement!==this.slWrap&&this._close()}},{key:"_clickHandler",value:function(t){var e=t.target.closest("li");e&&(e.hasAttribute("data-disabled")||e.hasAttribute("data-optgroup")?t.stopPropagation():(this.currentIndex=n(e,this.slItems),this._selection(),this._get(t)))}},{key:"_keyboardHandler",value:function(t){this.isFocus&&(t.which===this.KEYS.ENTER&&(t.preventDefault(),this.isOpen&&this._get(t)),t.which===this.KEYS.SPACE&&(t.preventDefault(),this._toggleHandler()),t.which===this.KEYS.ESC&&this._close(),t.which!==this.KEYS.UP&&t.which!==this.KEYS.DOWN||(t.preventDefault(),this._move(t.which),this._get(t)))}},{key:"_closeHandler",value:function(t){this.isOpen&&(t.target.classList.contains("".concat(this.selectClass,"-label"))||this._close())}},{key:"_move",value:function(t){var e=this.slList.querySelector("."+this.activeClass);this.currentIndex=n(e,this.slItems),t===this.KEYS.DOWN&&this._moveDown(),t===this.KEYS.UP&&this._moveUp(),this._selection(),this._scroll()}},{key:"_moveDown",value:function(){this.currentIndex+=1;var t=!1,e=this.slItems[this.currentIndex],s=o(e).some(function(t){return!t.hasAttribute("data-disabled")&&!t.hasAttribute("data-optgroup")});if(e&&(e.hasAttribute("data-disabled")||e.hasAttribute("data-optgroup"))&&(t=!0),this.currentIndex===this.listLength)this.currentIndex-=1;else if(t&&s)return this._moveDown();t&&!s&&(this.currentIndex-=1)}},{key:"_moveUp",value:function(){this.currentIndex-=1;var t=!1,e=this.slItems[this.currentIndex],s=l(e).some(function(t){return!t.hasAttribute("data-disabled")&&!t.hasAttribute("data-optgroup")});if(e&&(e.hasAttribute("data-disabled")||e.hasAttribute("data-optgroup"))&&(t=!0),-1===this.currentIndex)this.currentIndex+=1;else if(t&&s)return this._moveUp();t&&!s&&(this.currentIndex+=1)}},{key:"_selection",value:function(){var t=this.slItems[this.currentIndex];this.slList.querySelector(".".concat(this.activeClass)).classList.remove(this.activeClass),t.classList.add(this.activeClass),this.slTitle.textContent=t.textContent}},{key:"_get",value:function(t){var e=this.slList.querySelector(".".concat(this.activeClass));e.hasAttribute("data-disabled")||(this.settings.onChange(t,e.getAttribute("data-value"),e.textContent,this.currentIndex),this.options.forEach(function(t){t.removeAttribute("selected")}),this.options[this.currentIndex].setAttribute("selected",!0),"keydown"===t.type&&t.which!==this.KEYS.ENTER||this._close())}},{key:"_scroll",value:function(){var t=this.slList.getBoundingClientRect(),e=this.slItems[this.currentIndex].getBoundingClientRect();t.top>e.top?this.slList.scrollTop=this.slList.scrollTop-t.top+e.top:t.bottom<e.bottom&&(this.slList.scrollTop=this.slList.scrollTop-t.bottom+e.bottom)}},{key:"update",value:function(){this.slList.innerHTML="",this._genList()}},{key:"destroy",value:function(){for(var t in this._unbindEvents(),this.slWrap.removeChild(this.slList),this.slWrap.removeChild(this.slTitle),this.slWrap.parentNode.removeChild(this.slWrap),this.mainSelect.removeAttribute("hidden"),this)delete this[t]}}]),t}();e.default=h}]).default});